local Players=game:GetService("Players")
local RunService=game:GetService("RunService")
local UserInputService=game:GetService("UserInputService")
local TweenService=game:GetService("TweenService")
local player=Players.LocalPlayer
local camera=workspace.CurrentCamera
local FOV_RADIUS=150
local SMOOTHNESS=0.6
local TARGET_PART="Head"
local PREDICTION=0.15
local SENSITIVITY=1.0
local AimEnabled=false
local ESPEnabled=false
local ShowTracers=false
local ShowHealth=false
local LOCK_MODE="Crosshair"
local TEAM_CHECK=false
local espBoxes={}
local tracerLines={}
local ACCENT=Color3.fromRGB(100,180,255)
local GREEN=Color3.fromRGB(80,220,120)
local RED=Color3.fromRGB(220,70,70)
local ACTIVE=Color3.fromRGB(80,200,120)
local BG=Color3.fromRGB(15,15,15)
local BG2=Color3.fromRGB(22,22,22)
local BG3=Color3.fromRGB(30,30,30)
local TEXT=Color3.fromRGB(240,240,240)
local SUBTEXT=Color3.fromRGB(140,140,140)
local pulseUp=true
local pulseTween=nil
local guiOpen=true

local PRESETS={
	{name="Sky",color=Color3.fromRGB(100,180,255)},
	{name="Rose",color=Color3.fromRGB(255,100,140)},
	{name="Violet",color=Color3.fromRGB(160,100,255)},
	{name="Mint",color=Color3.fromRGB(80,220,160)},
	{name="Amber",color=Color3.fromRGB(255,180,60)},
}

local function isSameTeam(plr)
	if not TEAM_CHECK then return false end
	local myTeam=player.Team local theirTeam=plr.Team
	if myTeam and theirTeam then
		if myTeam==theirTeam then return true end
		if myTeam.Name==theirTeam.Name then return true end
		if myTeam.TeamColor==theirTeam.TeamColor then return true end
	end
	local myChar=player.Character local theirChar=plr.Character
	if myChar and theirChar then
		local ms=myChar:FindFirstChildOfClass("Shirt")
		local ts=theirChar:FindFirstChildOfClass("Shirt")
		if ms and ts and ms.ShirtTemplate==ts.ShirtTemplate then return true end
	end
	return false
end

local ScreenGui=Instance.new("ScreenGui")
ScreenGui.Name="AS2K"
ScreenGui.ResetOnSpawn=false
ScreenGui.IgnoreGuiInset=true
ScreenGui.Parent=player:WaitForChild("PlayerGui")

-- BACKDROP (click outside to close)
local Backdrop=Instance.new("TextButton")
Backdrop.Size=UDim2.new(1,0,1,0)
Backdrop.BackgroundColor3=Color3.new(0,0,0)
Backdrop.BackgroundTransparency=0.5
Backdrop.BorderSizePixel=0
Backdrop.Text=""
Backdrop.ZIndex=2
Backdrop.Visible=true
Backdrop.Parent=ScreenGui

-- MAIN POPUP
local Popup=Instance.new("Frame")
Popup.Size=UDim2.new(0,320,0,420)
Popup.AnchorPoint=Vector2.new(0.5,0.5)
Popup.Position=UDim2.new(0.5,0,0.5,0)
Popup.BackgroundColor3=BG
Popup.BorderSizePixel=0
Popup.ZIndex=3
Popup.Parent=ScreenGui
Instance.new("UICorner",Popup).CornerRadius=UDim.new(0,18)

-- SHADOW
local Shadow=Instance.new("ImageLabel")
Shadow.Size=UDim2.new(1,40,1,40)
Shadow.Position=UDim2.new(0,-20,0,-20)
Shadow.BackgroundTransparency=1
Shadow.Image="rbxassetid://6014261993"
Shadow.ImageColor3=Color3.new(0,0,0)
Shadow.ImageTransparency=0.3
Shadow.ScaleType=Enum.ScaleType.Slice
Shadow.SliceCenter=Rect.new(49,49,450,450)
Shadow.ZIndex=2
Shadow.Parent=Popup

-- TOP BAR
local TopBar=Instance.new("Frame")
TopBar.Size=UDim2.new(1,0,0,56)
TopBar.BackgroundTransparency=1
TopBar.ZIndex=3
TopBar.Parent=Popup

local AppName=Instance.new("TextLabel")
AppName.Size=UDim2.new(1,-60,1,0)
AppName.Position=UDim2.new(0,20,0,0)
AppName.BackgroundTransparency=1
AppName.Text="Aim Sexer 2000"
AppName.TextScaled=true
AppName.Font=Enum.Font.GothamBold
AppName.TextColor3=TEXT
AppName.TextXAlignment=Enum.TextXAlignment.Left
AppName.ZIndex=3
AppName.Parent=TopBar

local CloseBtn=Instance.new("TextButton")
CloseBtn.Size=UDim2.new(0,28,0,28)
CloseBtn.Position=UDim2.new(1,-46,0.5,-14)
CloseBtn.BackgroundColor3=BG3
CloseBtn.Text="✕"
CloseBtn.TextScaled=true
CloseBtn.Font=Enum.Font.GothamBold
CloseBtn.TextColor3=SUBTEXT
CloseBtn.ZIndex=3
CloseBtn.Parent=TopBar
Instance.new("UICorner",CloseBtn).CornerRadius=UDim.new(1,0)

-- DIVIDER
local Divider=Instance.new("Frame")
Divider.Size=UDim2.new(1,-40,0,1)
Divider.Position=UDim2.new(0,20,0,56)
Divider.BackgroundColor3=BG3
Divider.BorderSizePixel=0
Divider.ZIndex=3
Divider.Parent=Popup

-- TAB BAR
local TabBar=Instance.new("Frame")
TabBar.Size=UDim2.new(1,-40,0,36)
TabBar.Position=UDim2.new(0,20,0,68)
TabBar.BackgroundColor3=BG2
TabBar.BorderSizePixel=0
TabBar.ZIndex=3
TabBar.Parent=Popup
Instance.new("UICorner",TabBar).CornerRadius=UDim.new(0,10)

-- TAB INDICATOR (sliding pill)
local TabIndicator=Instance.new("Frame")
TabIndicator.Size=UDim2.new(1/3,-4,1,-4)
TabIndicator.Position=UDim2.new(0,2,0,2)
TabIndicator.BackgroundColor3=BG3
TabIndicator.BorderSizePixel=0
TabIndicator.ZIndex=4
TabIndicator.Parent=TabBar
Instance.new("UICorner",TabIndicator).CornerRadius=UDim.new(0,8)

local tabNames={"Aim","ESP","Theme"}
local tabs={}
local tabScrolls={}
local tabInners={}
local activeTab="Aim"
local activeTabIndex=1

for i,name in ipairs(tabNames) do
	local btn=Instance.new("TextButton")
	btn.Size=UDim2.new(1/#tabNames,0,1,0)
	btn.Position=UDim2.new((i-1)/#tabNames,0,0,0)
	btn.Text=name btn.TextScaled=true
	btn.Font=Enum.Font.GothamBold
	btn.BackgroundTransparency=1
	btn.TextColor3=name==activeTab and TEXT or SUBTEXT
	btn.ZIndex=5
	btn.Parent=TabBar
	tabs[name]=btn

	local scroll=Instance.new("ScrollingFrame")
	scroll.Size=UDim2.new(1,-40,1,-170)
	scroll.Position=UDim2.new(0,20,0,115)
	scroll.BackgroundTransparency=1
	scroll.BorderSizePixel=0
	scroll.ScrollBarThickness=2
	scroll.ScrollBarImageColor3=BG3
	scroll.ScrollingDirection=Enum.ScrollingDirection.Y
	scroll.CanvasSize=UDim2.new(0,0,0,500)
	scroll.Visible=name==activeTab
	scroll.ZIndex=3
	scroll.Parent=Popup
	tabScrolls[name]=scroll

	local inner=Instance.new("Frame")
	inner.Size=UDim2.new(1,0,0,500)
	inner.BackgroundTransparency=1
	inner.ZIndex=3
	inner.Parent=scroll
	tabInners[name]=inner
end

local accentListeners={}
local function registerAccent(obj,prop) table.insert(accentListeners,{obj=obj,prop=prop}) end
local function applyAccent(color)
	ACCENT=color
	for _,v in pairs(accentListeners) do pcall(function() v.obj[v.prop]=color end) end
	for n,btn in pairs(tabs) do if n==activeTab then btn.TextColor3=TEXT end end
end

local function switchTab(name)
	local idx=table.find(tabNames,name)
	activeTab=name activeTabIndex=idx
	TweenService:Create(TabIndicator,TweenInfo.new(0.2,Enum.EasingStyle.Quad,Enum.EasingDirection.Out),{
		Position=UDim2.new((idx-1)/#tabNames,2,0,2)
	}):Play()
	for n,btn in pairs(tabs) do
		TweenService:Create(btn,TweenInfo.new(0.15),{TextColor3=n==name and TEXT or SUBTEXT}):Play()
	end
	for n,s in pairs(tabScrolls) do s.Visible=n==name end
end

for name,btn in pairs(tabs) do
	btn.MouseButton1Click:Connect(function() switchTab(name) end)
end

-- STATUS BAR
local StatusBar=Instance.new("Frame")
StatusBar.Size=UDim2.new(1,-40,0,38)
StatusBar.Position=UDim2.new(0,20,1,-58)
StatusBar.BackgroundColor3=BG2
StatusBar.BorderSizePixel=0
StatusBar.ZIndex=3
StatusBar.Parent=Popup
Instance.new("UICorner",StatusBar).CornerRadius=UDim.new(0,10)

local StatusDot=Instance.new("Frame")
StatusDot.Size=UDim2.new(0,8,0,8)
StatusDot.Position=UDim2.new(0,14,0.5,-4)
StatusDot.BackgroundColor3=SUBTEXT
StatusDot.BorderSizePixel=0
StatusDot.ZIndex=4
StatusDot.Parent=StatusBar
Instance.new("UICorner",StatusDot).CornerRadius=UDim.new(1,0)

local StatusLbl=Instance.new("TextLabel")
StatusLbl.Size=UDim2.new(1,-36,1,0)
StatusLbl.Position=UDim2.new(0,30,0,0)
StatusLbl.BackgroundTransparency=1
StatusLbl.Text="Idle"
StatusLbl.TextScaled=true
StatusLbl.Font=Enum.Font.Gotham
StatusLbl.TextColor3=SUBTEXT
StatusLbl.TextXAlignment=Enum.TextXAlignment.Left
StatusLbl.ZIndex=4
StatusLbl.Parent=StatusBar

-- OPEN BUTTON (shown when GUI closed)
local OpenBtn=Instance.new("TextButton")
OpenBtn.Size=UDim2.new(0,44,0,44)
OpenBtn.Position=UDim2.new(0,16,0.5,-22)
OpenBtn.BackgroundColor3=BG
OpenBtn.Text="✦"
OpenBtn.TextScaled=true
OpenBtn.Font=Enum.Font.GothamBold
OpenBtn.TextColor3=ACCENT
OpenBtn.ZIndex=10
OpenBtn.Visible=false
OpenBtn.Parent=ScreenGui
Instance.new("UICorner",OpenBtn).CornerRadius=UDim.new(0,12)
registerAccent(OpenBtn,"TextColor3")

local Shadow2=Instance.new("ImageLabel")
Shadow2.Size=UDim2.new(1,20,1,20)
Shadow2.Position=UDim2.new(0,-10,0,-10)
Shadow2.BackgroundTransparency=1
Shadow2.Image="rbxassetid://6014261993"
Shadow2.ImageColor3=Color3.new(0,0,0)
Shadow2.ImageTransparency=0.4
Shadow2.ScaleType=Enum.ScaleType.Slice
Shadow2.SliceCenter=Rect.new(49,49,450,450)
Shadow2.ZIndex=9
Shadow2.Parent=OpenBtn

local function openGUI()
	guiOpen=true
	Backdrop.Visible=true
	Popup.Visible=true
	OpenBtn.Visible=false
	Popup.Size=UDim2.new(0,0,0,0)
	Popup.BackgroundTransparency=1
	TweenService:Create(Popup,TweenInfo.new(0.25,Enum.EasingStyle.Back,Enum.EasingDirection.Out),{
		Size=UDim2.new(0,320,0,420),
		BackgroundTransparency=0
	}):Play()
end

local function closeGUI()
	guiOpen=false
	TweenService:Create(Popup,TweenInfo.new(0.18,Enum.EasingStyle.Quad,Enum.EasingDirection.In),{
		Size=UDim2.new(0,280,0,380),
		BackgroundTransparency=0.3
	}):Play()
	task.delay(0.18,function()
		Popup.Visible=false
		Backdrop.Visible=false
		OpenBtn.Visible=true
	end)
end

CloseBtn.MouseButton1Click:Connect(closeGUI)
Backdrop.MouseButton1Click:Connect(closeGUI)
OpenBtn.MouseButton1Click:Connect(openGUI)

-- HELPERS
local function mkToggle(parent,text,pos)
	local row=Instance.new("Frame")
	row.Size=UDim2.new(1,0,0,40)
	row.Position=pos
	row.BackgroundColor3=BG2
	row.BorderSizePixel=0
	row.ZIndex=4
	row.Parent=parent
	Instance.new("UICorner",row).CornerRadius=UDim.new(0,10)

	local lbl=Instance.new("TextLabel")
	lbl.Size=UDim2.new(1,-60,1,0)
	lbl.Position=UDim2.new(0,14,0,0)
	lbl.BackgroundTransparency=1
	lbl.Text=text lbl.TextScaled=true
	lbl.Font=Enum.Font.Gotham
	lbl.TextColor3=TEXT
	lbl.TextXAlignment=Enum.TextXAlignment.Left
	lbl.ZIndex=5 lbl.Parent=row

	local pill=Instance.new("Frame")
	pill.Size=UDim2.new(0,40,0,22)
	pill.Position=UDim2.new(1,-54,0.5,-11)
	pill.BackgroundColor3=BG3
	pill.BorderSizePixel=0
	pill.ZIndex=5 pill.Parent=row
	Instance.new("UICorner",pill).CornerRadius=UDim.new(1,0)

	local knob=Instance.new("Frame")
	knob.Size=UDim2.new(0,16,0,16)
	knob.Position=UDim2.new(0,3,0.5,-8)
	knob.BackgroundColor3=SUBTEXT
	knob.BorderSizePixel=0
	knob.ZIndex=6 knob.Parent=pill
	Instance.new("UICorner",knob).CornerRadius=UDim.new(1,0)

	local state=false
	local function setState(v)
		state=v
		TweenService:Create(pill,TweenInfo.new(0.2),{BackgroundColor3=v and ACCENT or BG3}):Play()
		TweenService:Create(knob,TweenInfo.new(0.2),{
			Position=v and UDim2.new(1,-19,0.5,-8) or UDim2.new(0,3,0.5,-8),
			BackgroundColor3=v and Color3.new(1,1,1) or SUBTEXT
		}):Play()
	end

	row.InputBegan:Connect(function(i)
		if i.UserInputType==Enum.UserInputType.MouseButton1 or i.UserInputType==Enum.UserInputType.Touch then
			setState(not state)
		end
	end)

	registerAccent(pill,"BackgroundColor3")

	return row,function() return state end,setState
end

local function mkSliderRow(parent,label,pos,fillColor,initPct)
	local row=Instance.new("Frame")
	row.Size=UDim2.new(1,0,0,52)
	row.Position=pos
	row.BackgroundColor3=BG2
	row.BorderSizePixel=0
	row.ZIndex=4
	row.Parent=parent
	Instance.new("UICorner",row).CornerRadius=UDim.new(0,10)

	local lbl=Instance.new("TextLabel")
	lbl.Size=UDim2.new(0.6,0,0,22)
	lbl.Position=UDim2.new(0,14,0,8)
	lbl.BackgroundTransparency=1
	lbl.Text=label lbl.TextScaled=true
	lbl.Font=Enum.Font.Gotham
	lbl.TextColor3=TEXT
	lbl.TextXAlignment=Enum.TextXAlignment.Left
	lbl.ZIndex=5 lbl.Parent=row

	local valLbl=Instance.new("TextLabel")
	valLbl.Size=UDim2.new(0.35,0,0,22)
	valLbl.Position=UDim2.new(0.65,0,0,8)
	valLbl.BackgroundTransparency=1
	valLbl.Text="" valLbl.TextScaled=true
	valLbl.Font=Enum.Font.GothamBold
	valLbl.TextColor3=ACCENT
	valLbl.TextXAlignment=Enum.TextXAlignment.Right
	valLbl.ZIndex=5 valLbl.Parent=row
	registerAccent(valLbl,"TextColor3")

	local track=Instance.new("Frame")
	track.Size=UDim2.new(1,-28,0,6)
	track.Position=UDim2.new(0,14,0,34)
	track.BackgroundColor3=BG3
	track.BorderSizePixel=0
	track.ZIndex=5 track.Parent=row
	Instance.new("UICorner",track).CornerRadius=UDim.new(1,0)

	local fill=Instance.new("Frame")
	fill.Size=UDim2.new(initPct or 0,0,1,0)
	fill.BackgroundColor3=fillColor
	fill.BorderSizePixel=0
	fill.ZIndex=6 fill.Parent=track
	Instance.new("UICorner",fill).CornerRadius=UDim.new(1,0)

	return track,fill,valLbl
end

local function mkSegment(parent,options,pos,current)
	local row=Instance.new("Frame")
	row.Size=UDim2.new(1,0,0,40)
	row.Position=pos
	row.BackgroundColor3=BG2
	row.BorderSizePixel=0
	row.ZIndex=4 row.Parent=parent
	Instance.new("UICorner",row).CornerRadius=UDim.new(0,10)

	local selected=current
	local btns={}
	for i,opt in ipairs(options) do
		local btn=Instance.new("TextButton")
		btn.Size=UDim2.new(1/#options,-4,1,-8)
		btn.Position=UDim2.new((i-1)/#options,2,0,4)
		btn.Text=opt btn.TextScaled=true
		btn.Font=Enum.Font.GothamBold
		btn.BackgroundColor3=opt==current and BG3 or Color3.fromRGB(0,0,0)
		btn.BackgroundTransparency=opt==current and 0 or 1
		btn.TextColor3=opt==current and TEXT or SUBTEXT
		btn.BorderSizePixel=0
		btn.ZIndex=5 btn.Parent=row
		Instance.new("UICorner",btn).CornerRadius=UDim.new(0,8)
		btns[opt]=btn
		btn.MouseButton1Click:Connect(function()
			selected=opt
			for o,b in pairs(btns) do
				TweenService:Create(b,TweenInfo.new(0.15),{
					BackgroundTransparency=o==opt and 0 or 1,
					TextColor3=o==opt and TEXT or SUBTEXT,
					BackgroundColor3=BG3
				}):Play()
			end
		end)
	end
	return row,function() return selected end
end

local function sectionLabel(parent,text,pos)
	local l=Instance.new("TextLabel")
	l.Size=UDim2.new(1,0,0,18)
	l.Position=pos
	l.BackgroundTransparency=1
	l.Text=text:upper() l.TextScaled=true
	l.Font=Enum.Font.GothamBold
	l.TextColor3=SUBTEXT
	l.TextXAlignment=Enum.TextXAlignment.Left
	l.ZIndex=4 l.Parent=parent
	return l
end

-- AIM TAB
local ai=tabInners["Aim"]
sectionLabel(ai,"Aimlock",UDim2.new(0,0,0,0))
local _,getAim,setAim=mkToggle(ai,"Aimlock",UDim2.new(0,0,0,22))

sectionLabel(ai,"Target Part",UDim2.new(0,0,0,74))
local _,getTarget_=mkSegment(ai,{"Head","Torso"},UDim2.new(0,0,0,96),"Head")

sectionLabel(ai,"Lock Mode",UDim2.new(0,0,0,148))
local _,getLockMode=mkSegment(ai,{"Crosshair","Distance"},UDim2.new(0,0,0,170),LOCK_MODE)

sectionLabel(ai,"Team Check",UDim2.new(0,0,0,222))
local _,getTeamCheck,setTeamCheck=mkToggle(ai,"Skip Teammates",UDim2.new(0,0,0,244))

sectionLabel(ai,"FOV",UDim2.new(0,0,0,296))
local FOVtrack,FOVfill,FOVval=mkSliderRow(ai,"FOV Radius",UDim2.new(0,0,0,318),ACCENT,FOV_RADIUS/400)
FOVval.Text=tostring(FOV_RADIUS)
registerAccent(FOVfill,"BackgroundColor3")

sectionLabel(ai,"Smoothness",UDim2.new(0,0,0,382))
local SMtrack,SMfill,SMval=mkSliderRow(ai,"Lock Speed",UDim2.new(0,0,0,404),Color3.fromRGB(80,200,160),SMOOTHNESS)
SMval.Text=tostring(SMOOTHNESS)

sectionLabel(ai,"Prediction",UDim2.new(0,0,0,468))
local PRtrack,PRfill,PRval=mkSliderRow(ai,"Velocity Lead",UDim2.new(0,0,0,490),Color3.fromRGB(255,180,60),PREDICTION)
PRval.Text=tostring(PREDICTION)

-- ESP TAB
local ei=tabInners["ESP"]
sectionLabel(ei,"ESP",UDim2.new(0,0,0,0))
local _,getESP,setESP=mkToggle(ei,"Show Boxes",UDim2.new(0,0,0,22))

sectionLabel(ei,"Tracers",UDim2.new(0,0,0,74))
local _,getTracers,setTracers=mkToggle(ei,"Show Tracers",UDim2.new(0,0,0,96))

sectionLabel(ei,"Health Bars",UDim2.new(0,0,0,148))
local _,getHealth,setHealth=mkToggle(ei,"Show Health",UDim2.new(0,0,0,170))

-- THEME TAB
local ti=tabInners["Theme"]
sectionLabel(ti,"Accent Color",UDim2.new(0,0,0,0))

local presetBtns={}
for i,preset in ipairs(PRESETS) do
	local btn=Instance.new("TextButton")
	btn.Size=UDim2.new(1,0,0,38)
	btn.Position=UDim2.new(0,0,0,22+(i-1)*46)
	btn.Text="" btn.ZIndex=4
	btn.BackgroundColor3=BG2
	btn.BorderSizePixel=0
	btn.Parent=ti
	Instance.new("UICorner",btn).CornerRadius=UDim.new(0,10)

	local swatch=Instance.new("Frame")
	swatch.Size=UDim2.new(0,20,0,20)
	swatch.Position=UDim2.new(0,10,0.5,-10)
	swatch.BackgroundColor3=preset.color
	swatch.BorderSizePixel=0
	swatch.ZIndex=5 swatch.Parent=btn
	Instance.new("UICorner",swatch).CornerRadius=UDim.new(1,0)

	local name=Instance.new("TextLabel")
	name.Size=UDim2.new(1,-50,1,0)
	name.Position=UDim2.new(0,40,0,0)
	name.BackgroundTransparency=1
	name.Text=preset.name name.TextScaled=true
	name.Font=Enum.Font.GothamBold
	name.TextColor3=TEXT
	name.TextXAlignment=Enum.TextXAlignment.Left
	name.ZIndex=5 name.Parent=btn

	local check=Instance.new("TextLabel")
	check.Size=UDim2.new(0,20,0,20)
	check.Position=UDim2.new(1,-32,0.5,-10)
	check.BackgroundTransparency=1
	check.Text="✓" check.TextScaled=true
	check.Font=Enum.Font.GothamBold
	check.TextColor3=preset.color
	check.Visible=i==1
	check.ZIndex=5 check.Parent=btn
	presetBtns[i]={btn=btn,check=check}

	btn.MouseButton1Click:Connect(function()
		applyAccent(preset.color)
		swatch.BackgroundColor3=preset.color
		for j,pb in pairs(presetBtns) do
			pb.check.Visible=j==i
		end
	end)
end

-- FOV CIRCLE
local FOVCircle=Instance.new("Frame")
FOVCircle.AnchorPoint=Vector2.new(0.5,0.5)
FOVCircle.Position=UDim2.new(0.5,0,0.5,0)
FOVCircle.Size=UDim2.new(0,FOV_RADIUS*2,0,FOV_RADIUS*2)
FOVCircle.BackgroundColor3=ACCENT
FOVCircle.BackgroundTransparency=0.8
FOVCircle.BorderSizePixel=0
FOVCircle.Visible=false
FOVCircle.ZIndex=1
FOVCircle.Parent=ScreenGui
Instance.new("UICorner",FOVCircle).CornerRadius=UDim.new(1,0)
registerAccent(FOVCircle,"BackgroundColor3")

local TargetDisplay=Instance.new("TextLabel")
TargetDisplay.Size=UDim2.new(0,180,0,26)
TargetDisplay.AnchorPoint=Vector2.new(0.5,0.5)
TargetDisplay.Position=UDim2.new(0.5,0,0.5,-(FOV_RADIUS+20))
TargetDisplay.BackgroundColor3=Color3.fromRGB(0,0,0)
TargetDisplay.BackgroundTransparency=0.5
TargetDisplay.TextScaled=true
TargetDisplay.Font=Enum.Font.GothamBold
TargetDisplay.TextColor3=ACCENT
TargetDisplay.Visible=false
TargetDisplay.ZIndex=1
TargetDisplay.Parent=ScreenGui
Instance.new("UICorner",TargetDisplay).CornerRadius=UDim.new(0,8)
registerAccent(TargetDisplay,"TextColor3")

-- PULSE
local function startPulse()
	if pulseTween then pulseTween:Cancel() end
	local function doPulse()
		if not AimEnabled then FOVCircle.BackgroundTransparency=0.8 return end
		local t=pulseUp and 0.65 or 0.9
		pulseUp=not pulseUp
		pulseTween=TweenService:Create(FOVCircle,TweenInfo.new(0.9,Enum.EasingStyle.Sine,Enum.EasingDirection.InOut),{BackgroundTransparency=t})
		pulseTween:Play()
		pulseTween.Completed:Connect(function() if AimEnabled then doPulse() end end)
	end
	doPulse()
end

local function stopPulse()
	if pulseTween then pulseTween:Cancel() pulseTween=nil end
	FOVCircle.BackgroundTransparency=0.8
end

-- SLIDER LOGIC
local activeSlider=nil
local sliders={
	{FOVtrack,FOVfill,FOVval,400,false},
	{SMtrack,SMfill,SMval,1,true},
	{PRtrack,PRfill,PRval,1,true},
}

local function doSlider(i,x)
	local s=sliders[i]
	local p=math.clamp((x-s[1].AbsolutePosition.X)/s[1].AbsoluteSize.X,0,1)
	local v=s[5] and math.floor(p*s[4]*100)/100 or math.floor(p*s[4])
	s[2].Size=UDim2.new(p,0,1,0)
	s[3].Text=tostring(v)
	if i==1 then FOV_RADIUS=v FOVCircle.Size=UDim2.new(0,v*2,0,v*2) TargetDisplay.Position=UDim2.new(0.5,0,0.5,-(v+20))
	elseif i==2 then SMOOTHNESS=v
	elseif i==3 then PREDICTION=v end
end

for i,s in ipairs(sliders) do
	s[1].InputBegan:Connect(function(inp)
		if inp.UserInputType==Enum.UserInputType.MouseButton1 or inp.UserInputType==Enum.UserInputType.Touch then
			activeSlider=i doSlider(i,inp.Position.X)
		end
	end)
end

UserInputService.InputChanged:Connect(function(inp)
	if activeSlider and (inp.UserInputType==Enum.UserInputType.MouseMovement or inp.UserInputType==Enum.UserInputType.Touch) then
		doSlider(activeSlider,inp.Position.X)
	end
end)

UserInputService.InputEnded:Connect(function(inp)
	if inp.UserInputType==Enum.UserInputType.MouseButton1 or inp.UserInputType==Enum.UserInputType.Touch then
		activeSlider=nil
	end
end)

-- ESP
local function getBox(plr)
	if espBoxes[plr] then return espBoxes[plr] end
	local box=Instance.new("Frame")
	box.BackgroundTransparency=1 box.BorderSi
