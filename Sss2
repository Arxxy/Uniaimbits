local Players=game:GetService("Players")
local RunService=game:GetService("RunService")
local UserInputService=game:GetService("UserInputService")
local TweenService=game:GetService("TweenService")
local player=Players.LocalPlayer
local camera=workspace.CurrentCamera
local FOV_RADIUS=150
local SMOOTHNESS=0.6
local TARGET_PART="Head"
local PREDICTION=0.15
local AimEnabled=false
local ESPEnabled=false
local MINIMIZED=false
local espBoxes={}
local ACCENT=Color3.fromRGB(0,170,255)
local GREEN=Color3.fromRGB(0,200,80)
local RED=Color3.fromRGB(150,0,0)
local ACTIVE=Color3.fromRGB(0,170,0)
local pulseUp=true
local pulseTween=nil

local PRESETS={
	{name="Blue", color=Color3.fromRGB(0,170,255)},
	{name="Red", color=Color3.fromRGB(255,60,60)},
	{name="Purple", color=Color3.fromRGB(170,0,255)},
	{name="Green", color=Color3.fromRGB(0,220,100)},
	{name="Orange", color=Color3.fromRGB(255,140,0)},
}

local ScreenGui=Instance.new("ScreenGui")
ScreenGui.Name="AimSexer2000"
ScreenGui.ResetOnSpawn=false
ScreenGui.IgnoreGuiInset=true
ScreenGui.Parent=player:WaitForChild("PlayerGui")

-- DROP SHADOW
local Shadow=Instance.new("ImageLabel")
Shadow.Size=UDim2.new(1,30,1,30)
Shadow.Position=UDim2.new(0,-15,0,-15)
Shadow.BackgroundTransparency=1
Shadow.Image="rbxassetid://6014261993"
Shadow.ImageColor3=Color3.new(0,0,0)
Shadow.ImageTransparency=0.5
Shadow.ScaleType=Enum.ScaleType.Slice
Shadow.SliceCenter=Rect.new(49,49,450,450)
Shadow.Parent=ScreenGui
Shadow.ZIndex=0

local MainFrame=Instance.new("Frame")
MainFrame.Size=UDim2.new(0,180,0,340)
MainFrame.Position=UDim2.new(0.5,-90,0.5,-170)
MainFrame.BackgroundColor3=Color3.fromRGB(22,22,22)
MainFrame.BorderSizePixel=0
MainFrame.Active=true
MainFrame.ZIndex=1
MainFrame.Parent=ScreenGui
Instance.new("UICorner",MainFrame).CornerRadius=UDim.new(0,14)

local function syncShadow()
	Shadow.Position=UDim2.new(
		MainFrame.Position.X.Scale,MainFrame.Position.X.Offset-15,
		MainFrame.Position.Y.Scale,MainFrame.Position.Y.Offset-15
	)
	Shadow.Size=UDim2.new(0,MainFrame.AbsoluteSize.X+30,0,MainFrame.AbsoluteSize.Y+30)
end

local TitleBar=Instance.new("Frame")
TitleBar.Size=UDim2.new(1,0,0,40)
TitleBar.BackgroundColor3=Color3.fromRGB(30,30,30)
TitleBar.BorderSizePixel=0
TitleBar.Active=true
TitleBar.Parent=MainFrame
Instance.new("UICorner",TitleBar).CornerRadius=UDim.new(0,14)

local fix=Instance.new("Frame")
fix.Size=UDim2.new(1,0,0,14)
fix.Position=UDim2.new(0,0,1,-14)
fix.BackgroundColor3=Color3.fromRGB(30,30,30)
fix.BorderSizePixel=0
fix.Parent=TitleBar

local TitleLbl=Instance.new("TextLabel")
TitleLbl.Size=UDim2.new(1,-44,1,0)
TitleLbl.Position=UDim2.new(0,10,0,0)
TitleLbl.BackgroundTransparency=1
TitleLbl.Text="Aim Sexer 2000"
TitleLbl.TextScaled=true
TitleLbl.Font=Enum.Font.GothamBold
TitleLbl.TextColor3=Color3.new(1,1,1)
TitleLbl.TextXAlignment=Enum.TextXAlignment.Left
TitleLbl.Parent=TitleBar

local MinBtn=Instance.new("TextButton")
MinBtn.Size=UDim2.new(0,28,0,28)
MinBtn.Position=UDim2.new(1,-34,0.5,-14)
MinBtn.Text="-"
MinBtn.TextScaled=true
MinBtn.Font=Enum.Font.GothamBold
MinBtn.BackgroundColor3=Color3.fromRGB(60,60,60)
MinBtn.TextColor3=Color3.new(1,1,1)
MinBtn.Parent=TitleBar
Instance.new("UICorner",MinBtn).CornerRadius=UDim.new(0,8)

local TabBar=Instance.new("Frame")
TabBar.Size=UDim2.new(1,0,0,30)
TabBar.Position=UDim2.new(0,0,0,40)
TabBar.BackgroundColor3=Color3.fromRGB(28,28,28)
TabBar.BorderSizePixel=0
TabBar.Parent=MainFrame

local tabNames={"Aim","ESP","Theme"}
local tabs={}
local tabScrolls={}
local tabInners={}
local activeTab="Aim"

for i,name in ipairs(tabNames) do
	local btn=Instance.new("TextButton")
	btn.Size=UDim2.new(1/#tabNames,0,1,0)
	btn.Position=UDim2.new((i-1)/#tabNames,0,0,0)
	btn.Text=name
	btn.TextScaled=true
	btn.Font=Enum.Font.GothamBold
	btn.BackgroundColor3=name==activeTab and Color3.fromRGB(35,35,35) or Color3.fromRGB(28,28,28)
	btn.TextColor3=name==activeTab and ACCENT or Color3.fromRGB(150,150,150)
	btn.BorderSizePixel=0
	btn.Parent=TabBar
	tabs[name]=btn

	local scroll=Instance.new("ScrollingFrame")
	scroll.Size=UDim2.new(1,0,1,-100)
	scroll.Position=UDim2.new(0,0,0,70)
	scroll.BackgroundTransparency=1
	scroll.BorderSizePixel=0
	scroll.ScrollBarThickness=3
	scroll.ScrollBarImageColor3=ACCENT
	scroll.ScrollingDirection=Enum.ScrollingDirection.Y
	scroll.CanvasSize=UDim2.new(0,0,0,300)
	scroll.Visible=name==activeTab
	scroll.Parent=MainFrame
	tabScrolls[name]=scroll

	local inner=Instance.new("Frame")
	inner.Size=UDim2.new(1,0,0,300)
	inner.BackgroundTransparency=1
	inner.BorderSizePixel=0
	inner.Parent=scroll
	tabInners[name]=inner
end

-- ACCENT UPDATE FUNCTION
local accentListeners={}
local function registerAccent(obj,prop)
	table.insert(accentListeners,{obj=obj,prop=prop})
end

local function applyAccent(color)
	ACCENT=color
	for _,v in pairs(accentListeners) do
		pcall(function() v.obj[v.prop]=color end)
	end
	for n,btn in pairs(tabs) do
		if n==activeTab then btn.TextColor3=color end
	end
	for _,s in pairs(tabScrolls) do
		s.ScrollBarImageColor3=color
	end
end

local function switchTab(name)
	activeTab=name
	for n,btn in pairs(tabs) do
		btn.BackgroundColor3=n==name and Color3.fromRGB(35,35,35) or Color3.fromRGB(28,28,28)
		btn.TextColor3=n==name and ACCENT or Color3.fromRGB(150,150,150)
	end
	for n,s in pairs(tabScrolls) do s.Visible=n==name end
end

for name,btn in pairs(tabs) do
	btn.MouseButton1Click:Connect(function() switchTab(name) end)
end

-- STATUS BAR
local StatusBar=Instance.new("Frame")
StatusBar.Size=UDim2.new(1,0,0,30)
StatusBar.Position=UDim2.new(0,0,1,-30)
StatusBar.BackgroundColor3=Color3.fromRGB(18,18,18)
StatusBar.BorderSizePixel=0
StatusBar.Parent=MainFrame
Instance.new("UICorner",StatusBar).CornerRadius=UDim.new(0,14)

local statusFix=Instance.new("Frame")
statusFix.Size=UDim2.new(1,0,0,14)
statusFix.Position=UDim2.new(0,0,0,0)
statusFix.BackgroundColor3=Color3.fromRGB(18,18,18)
statusFix.BorderSizePixel=0
statusFix.Parent=StatusBar

local StatusLbl=Instance.new("TextLabel")
StatusLbl.Size=UDim2.new(1,-8,1,0)
StatusLbl.Position=UDim2.new(0,8,0,0)
StatusLbl.BackgroundTransparency=1
StatusLbl.Text="â— Idle"
StatusLbl.TextScaled=true
StatusLbl.Font=Enum.Font.Gotham
StatusLbl.TextColor3=Color3.fromRGB(150,150,150)
StatusLbl.TextXAlignment=Enum.TextXAlignment.Left
StatusLbl.Parent=StatusBar

-- HELPERS
local function mkBtn(parent,text,pos,color)
	local b=Instance.new("TextButton")
	b.Size=UDim2.new(0.9,0,0,34)
	b.Position=pos
	b.Text=text b.TextScaled=true
	b.Font=Enum.Font.Gotham
	b.BackgroundColor3=color or RED
	b.TextColor3=Color3.new(1,1,1)
	b.Parent=parent
	Instance.new("UICorner",b).CornerRadius=UDim.new(0,10)
	return b
end

local function mkLabel(parent,text,pos)
	local l=Instance.new("TextLabel")
	l.Size=UDim2.new(0.9,0,0,18)
	l.Position=pos
	l.BackgroundTransparency=1
	l.Text=text l.TextScaled=true
	l.Font=Enum.Font.Gotham
	l.TextColor3=Color3.new(1,1,1)
	l.Parent=parent
	return l
end

local function mkSlider(parent,pos,fillColor,initPct)
	local bg=Instance.new("Frame")
	bg.Size=UDim2.new(0.9,0,0,16)
	bg.Position=pos
	bg.BackgroundColor3=Color3.fromRGB(45,45,45)
	bg.Parent=parent
	Instance.new("UICorner",bg).CornerRadius=UDim.new(0,10)
	local fill=Instance.new("Frame")
	fill.Size=UDim2.new(initPct or 0,0,1,0)
	fill.BackgroundColor3=fillColor
	fill.Parent=bg
	Instance.new("UICorner",fill).CornerRadius=UDim.new(0,10)
	return bg,fill
end

-- AIM TAB
local aimInner=tabInners["Aim"]
local AimToggle=mkBtn(aimInner,"Aimlock: OFF",UDim2.new(0.05,0,0,6))
local TargetLabel=mkLabel(aimInner,"Target: Head",UDim2.new(0.05,0,0,48))

local partBtns={}
for i,part in ipairs({"Head","Torso"}) do
	local btn=Instance.new("TextButton")
	btn.Size=UDim2.new(0.42,0,0,24)
	btn.Position=UDim2.new(0.05+(i-1)*0.48,0,0,68)
	btn.Text=part btn.TextScaled=true
	btn.Font=Enum.Font.Gotham
	btn.BackgroundColor3=part==TARGET_PART and Color3.fromRGB(0,120,200) or Color3.fromRGB(55,55,55)
	btn.TextColor3=Color3.new(1,1,1)
	btn.Parent=aimInner
	Instance.new("UICorner",btn).CornerRadius=UDim.new(0,8)
	partBtns[part]=btn
	btn.MouseButton1Click:Connect(function()
		TARGET_PART=part
		TargetLabel.Text="Target: "..part
		for p,b in pairs(partBtns) do
			b.BackgroundColor3=p==TARGET_PART and Color3.fromRGB(0,120,200) or Color3.fromRGB(55,55,55)
		end
	end)
end

local FOVLabel=mkLabel(aimInner,"FOV: "..FOV_RADIUS,UDim2.new(0.05,0,0,102))
local FOVbg,FOVfill=mkSlider(aimInner,UDim2.new(0.05,0,0,122),ACCENT,FOV_RADIUS/400)
registerAccent(FOVfill,"BackgroundColor3")

local SMLabel=mkLabel(aimInner,"Smooth: "..SMOOTHNESS,UDim2.new(0.05,0,0,148))
local SMbg,SMfill=mkSlider(aimInner,UDim2.new(0.05,0,0,168),Color3.fromRGB(0,200,120),SMOOTHNESS)

local PRLabel=mkLabel(aimInner,"Predict: "..PREDICTION,UDim2.new(0.05,0,0,194))
local PRbg,PRfill=mkSlider(aimInner,UDim2.new(0.05,0,0,214),Color3.fromRGB(255,170,0),PREDICTION)

-- ESP TAB
local espInner=tabInners["ESP"]
local ESPToggle=mkBtn(espInner,"ESP: OFF",UDim2.new(0.05,0,0,6))
local espInfo=mkLabel(espInner,"Shows boxes + stud distance",UDim2.new(0.05,0,0,48))
espInfo.TextColor3=Color3.fromRGB(120,120,120)

-- THEME TAB
local themeInner=tabInners["Theme"]
local themeTitle=mkLabel(themeInner,"Accent Color",UDim2.new(0.05,0,0,6))
themeTitle.TextColor3=Color3.fromRGB(180,180,180)

local presetBtns={}
for i,preset in ipairs(PRESETS) do
	local row=math.ceil(i/2)-1
	local col=(i-1)%2
	local btn=Instance.new("TextButton")
	btn.Size=UDim2.new(0.42,0,0,30)
	btn.Position=UDim2.new(0.05+col*0.48,0,0,28+row*38)
	btn.Text=preset.name
	btn.TextScaled=true
	btn.Font=Enum.Font.GothamBold
	btn.BackgroundColor3=preset.color
	btn.TextColor3=Color3.new(1,1,1)
	btn.BorderSizePixel=0
	btn.Parent=themeInner
	Instance.new("UICorner",btn).CornerRadius=UDim.new(0,10)
	presetBtns[i]=btn
	btn.MouseButton1Click:Connect(function()
		applyAccent(preset.color)
		-- highlight selected
		for _,b in pairs(presetBtns) do
			b.BorderSizePixel=0
		end
		btn.BorderSizePixel=3
	end)
end

-- FOV CIRCLE
local FOVCircle=Instance.new("Frame")
FOVCircle.AnchorPoint=Vector2.new(0.5,0.5)
FOVCircle.Position=UDim2.new(0.5,0,0.5,0)
FOVCircle.Size=UDim2.new(0,FOV_RADIUS*2,0,FOV_RADIUS*2)
FOVCircle.BackgroundColor3=ACCENT
FOVCircle.BackgroundTransparency=0.75
FOVCircle.BorderSizePixel=0
FOVCircle.Visible=false
FOVCircle.Parent=ScreenGui
Instance.new("UICorner",FOVCircle).CornerRadius=UDim.new(1,0)
registerAccent(FOVCircle,"BackgroundColor3")

local TargetDisplay=Instance.new("TextLabel")
TargetDisplay.Size=UDim2.new(0,180,0,24)
TargetDisplay.AnchorPoint=Vector2.new(0.5,0.5)
TargetDisplay.Position=UDim2.new(0.5,0,0.5,-(FOV_RADIUS+18))
TargetDisplay.BackgroundColor3=Color3.fromRGB(0,0,0)
TargetDisplay.BackgroundTransparency=0.4
TargetDisplay.TextScaled=true
TargetDisplay.Font=Enum.Font.GothamBold
TargetDisplay.TextColor3=ACCENT
TargetDisplay.Visible=false
TargetDisplay.Parent=ScreenGui
Instance.new("UICorner",TargetDisplay).CornerRadius=UDim.new(0,8)
registerAccent(TargetDisplay,"TextColor3")

-- PULSE FUNCTION
local function startPulse()
	if pulseTween then pulseTween:Cancel() end
	local function doPulse()
		if not AimEnabled then FOVCircle.BackgroundTransparency=0.75 return end
		local target=pulseUp and 0.6 or 0.88
		pulseUp=not pulseUp
		pulseTween=TweenService:Create(FOVCircle,TweenInfo.new(0.8,Enum.EasingStyle.Sine,Enum.EasingDirection.InOut),{BackgroundTransparency=target})
		pulseTween:Play()
		pulseTween.Completed:Connect(function()
			if AimEnabled then doPulse() end
		end)
	end
	doPulse()
end

local function stopPulse()
	if pulseTween then pulseTween:Cancel() pulseTween=nil end
	FOVCircle.BackgroundTransparency=0.75
end

-- TOGGLES
AimToggle.MouseButton1Click:Connect(function()
	AimEnabled=not AimEnabled
	AimToggle.Text="Aimlock: "..(AimEnabled and "ON" or "OFF")
	AimToggle.BackgroundColor3=AimEnabled and ACTIVE or RED
	FOVCircle.Visible=AimEnabled
	if AimEnabled then
		startPulse()
	else
		stopPulse()
		TargetDisplay.Visible=false
		FOVCircle.BackgroundColor3=ACCENT
	end
end)

ESPToggle.MouseButton1Click:Connect(function()
	ESPEnabled=not ESPEnabled
	ESPToggle.Text="ESP: "..(ESPEnabled and "ON" or "OFF")
	ESPToggle.BackgroundColor3=ESPEnabled and ACTIVE or RED
	if not ESPEnabled then for _,b in pairs(espBoxes) do b:Destroy() end espBoxes={} end
end)

MinBtn.MouseButton1Click:Connect(function()
	MINIMIZED=not MINIMIZED
	TabBar.Visible=not MINIMIZED
	StatusBar.Visible=not MINIMIZED
	for _,s in pairs(tabScrolls) do s.Visible=false end
	if not MINIMIZED then tabScrolls[activeTab].Visible=true end
	MainFrame.Size=MINIMIZED and UDim2.new(0,180,0,40) or UDim2.new(0,180,0,340)
	MinBtn.Text=MINIMIZED and "+" or "-"
	syncShadow()
end)

-- DRAG
local dragInput,dragStart,frameStart
TitleBar.InputBegan:Connect(function(i)
	if i.UserInputType==Enum.UserInputType.MouseButton1 or i.UserInputType==Enum.UserInputType.Touch then
		dragInput=i dragStart=i.Position frameStart=MainFrame.Position
	end
end)
UserInputService.InputChanged:Connect(function(i)
	if i==dragInput and dragStart and frameStart then
		local d=i.Position-dragStart
		MainFrame.Position=UDim2.new(frameStart.X.Scale,frameStart.X.Offset+d.X,frameStart.Y.Scale,frameStart.Y.Offset+d.Y)
		syncShadow()
	end
end)
UserInputService.InputEnded:Connect(function(i)
	if i==dragInput then dragInput=nil dragStart=nil frameStart=nil end
end)

-- SLIDERS
local active={}
local sliders={
	{FOVbg,FOVfill,FOVLabel,"FOV: ",400,false},
	{SMbg,SMfill,SMLabel,"Smooth: ",1,true},
	{PRbg,PRfill,PRLabel,"Predict: ",1,true},
}

local function doSlider(i,s,x)
	local p=math.clamp((x-s[1].AbsolutePosition.X)/s[1].AbsoluteSize.X,0,1)
	local v=s[6] and math.floor(p*s[5]*100)/100 or math.floor(p*s[5])
	s[2].Size=UDim2.new(p,0,1,0)
	s[3].Text=s[4]..v
	if i==1 then FOV_RADIUS=v FOVCircle.Size=UDim2.new(0,v*2,0,v*2) TargetDisplay.Position=UDim2.new(0.5,0,0.5,-(v+18))
	elseif i==2 then SMOOTHNESS=v
	elseif i==3 then PREDICTION=v end
end

for i,s in ipairs(sliders) do
	s[1].InputBegan:Connect(function(inp)
		if inp.UserInputType==Enum.UserInputType.MouseButton1 or inp.UserInputType==Enum.UserInputType.Touch then
			active[i]=true doSlider(i,s,inp.Position.X)
		end
	end)
end

UserInputService.InputChanged:Connect(function(inp)
	if inp.UserInputType==Enum.UserInputType.MouseMovement or inp.UserInputType==Enum.UserInputType.Touch then
		for i,s in ipairs(sliders) do if active[i] then doSlider(i,s,inp.Position.X) end end
	end
end)

UserInputService.InputEnded:Connect(function(inp)
	if inp.UserInputType==Enum.UserInputType.MouseButton1 or inp.UserInputType==Enum.UserInputType.Touch then
		for i in pairs(active) do active[i]=false end
	end
end)

-- ESP
local function getBox(plr)
	if espBoxes[plr] then return espBoxes[plr] end
	local box=Instance.new("Frame")
	box.BackgroundTransparency=1 box.BorderSizePixel=0 box.Parent=ScreenGui
	local function line() local f=Instance.new("Frame") f.BackgroundColor3=Color3.fromRGB(255,50,50) f.BorderSizePixel=0 f.Parent=box return f end
	local t,b,l,r=line(),line(),line(),line()
	t.Size=UDim2.new(1,0,0,2) t.Position=UDim2.new(0,0,0,0)
	b.Size=UDim2.new(1,0,0,2) b.Position=UDim2.new(0,0,1,-2)
	l.Size=UDim2.new(0,2,1,0) l.Position=UDim2.new(0,0,0,0)
	r.Size=UDim2.new(0,2,1,0) r.Position=UDim2.new(1,-2,0,0)
	local dl=Instance.new("TextLabel")
	dl.Name="Dist" dl.Size=UDim2.new(1,0,0,16) dl.Position=UDim2.new(0,0,0,-18)
	dl.BackgroundTransparency=1 dl.TextScaled=true dl.Font=Enum.Font.GothamBold
	dl.TextColor3=Color3.new(1,1,1) dl.Parent=box
	espBoxes[plr]=box return box
end

local function removeBox(plr) if espBoxes[plr] then espBoxes[plr]:Destroy() espBoxes[plr]=nil end end
Players.PlayerRemoving:Connect(removeBox)

local function isVisible(part)
	local rp=RaycastParams.new()
	rp.FilterType=Enum.RaycastFilterType.Exclude
	rp.FilterDescendantsInstances={player.Character}
	local res=workspace:Raycast(camera.CFrame.Position,part.Position-camera.CFrame.Position,rp)
	return not res or res.Instance:IsDescendantOf(part.Parent)
end

local function getTarget()
	local closest,closestPlr,shortest=nil,nil,math.huge
	for _,plr in pairs(Players:GetPlayers()) do
		if plr~=player and plr.Character and plr.Character:FindFirstChild("HumanoidRootPart") and plr.Character:FindFirstChild("Humanoid") and plr.Character.Humanoid.Health>0 then
			local part=plr.Character:FindFirstChild(TARGET_PART) or plr.Character.HumanoidRootPart
			local sp,on=camera:WorldToViewportPoint(part.Position)
			if on then
				local d=(Vector2.new(sp.X,sp.Y)-Vector2.new(camera.ViewportSize.X/2,camera.ViewportSize.Y/2)).Magnitude
				if d<FOV_RADIUS and d<shortest and isVisible(part) then shortest=d closest=part closestPlr=plr end
			end
		end
	end
	TargetDisplay.Text=closestPlr and "ðŸŽ¯ "..closestPlr.Name or ""
	TargetDisplay.Visible=closestPlr~=nil
	return closest,closestPlr
end

local function updateStatus(locked,target)
	if not AimEnabled and not ESPEnabled then
		StatusLbl.Text="â— Idle" StatusLbl.TextColor3=Color3.fromRGB(120,120,120)
	elseif locked and target then
		StatusLbl.Text="â— Locked: "..target.Name StatusLbl.TextColor3=GREEN
	elseif AimEnabled then
		StatusLbl.Text="â— Searching..." StatusLbl.TextColor3=ACCENT
	else
		StatusLbl.Text="â— ESP Active" StatusLbl.TextColor3=Color3.fromRGB(255,50,50)
	end
end

syncShadow()

RunService.RenderStepped:Connect(function()
	local myHRP=player.Character and player.Character:FindFirstChild("HumanoidRootPart")
	for _,plr in pairs(Players:GetPlayers()) do
		if plr==player then continue end
		if ESPEnabled and plr.Character and plr.Character:FindFirstChild("HumanoidRootPart") and plr.Character:FindFirstChild("Humanoid") and plr.Character.Humanoid.Health>0 then
			local hrp=plr.Character.HumanoidRootPart
			local head=plr.Character:FindFirstChild("Head")
			local dist=myHRP and math.floor((myHRP.Position-hrp.Position).Magnitude) or math.huge
			local rs,rv=camera:WorldToViewportPoint(hrp.Position)
			local hs=camera:WorldToViewportPoint(head and head.Position or hrp.Position)
			if rv then
				local box=getBox(plr) box.Visible=true
				local h=math.abs(hs.Y-rs.Y)*2.2 local w=h*0.6
				box.Size=UDim2.new(0,w,0,h)
				box.Position=UDim2.new(0,rs.X-w/2,0,rs.Y-h/1.2)
				local dl=box:FindFirstChild("Dist")
				if dl then dl.Text=dist.." studs" end
			else if espBoxes[plr] then espBoxes[plr].Visible=false end end
		else removeBox(plr) end
	end

	if not AimEnabled then
		TargetDisplay.Visible=false
		updateStatus(false,nil) return
	end

	local target,closestPlr=getTarget()
	local locked=target~=nil
	if locked then
		FOVCircle.BackgroundColor3=GREEN
	else
		FOVCircle.BackgroundColor3=ACCENT
	end
	updateStatus(locked,closestPlr)
	if not target then return end
	local hrp=target.Parent and target.Parent:FindFirstChild("HumanoidRootPart")
	local vel=hrp and hrp.AssemblyLinearVelocity or Vector3.new()
	local predicted=target.Position+(vel*PREDICTION)
	local camPos=camera.CFrame.Position
	local goal=CFrame.new(camPos,predicted)
	local lerped=camera.CFrame:Lerp(goal,SMOOTHNESS)
	camera.CFrame=CFrame.new(camPos)*(lerped-lerped.Position)
end)
